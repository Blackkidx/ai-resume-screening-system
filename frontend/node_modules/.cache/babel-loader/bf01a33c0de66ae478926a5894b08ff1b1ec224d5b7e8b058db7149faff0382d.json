{"ast":null,"code":"// frontend/src/services/authService.js\nimport { API_BASE_URL } from '../config';\nclass AuthService {\n  constructor() {\n    this.baseURL = API_BASE_URL;\n  }\n\n  // ดึง token จาก localStorage\n  getToken() {\n    return localStorage.getItem('token');\n  }\n\n  // บันทึก token ลง localStorage\n  setToken(token) {\n    localStorage.setItem('token', token);\n  }\n\n  // ลบ token จาก localStorage\n  removeToken() {\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n  }\n\n  // ดึงข้อมูล user จาก localStorage\n  getCurrentUser() {\n    const userStr = localStorage.getItem('user');\n    return userStr ? JSON.parse(userStr) : null;\n  }\n\n  // บันทึกข้อมูล user ลง localStorage\n  setCurrentUser(user) {\n    localStorage.setItem('user', JSON.stringify(user));\n  }\n\n  // สร้าง headers สำหรับ API requests\n  getAuthHeaders() {\n    const token = this.getToken();\n    return {\n      'Content-Type': 'application/json',\n      ...(token && {\n        'Authorization': `Bearer ${token}`\n      })\n    };\n  }\n\n  // ✅ สมัครสมาชิก\n  async register(userData) {\n    try {\n      const response = await fetch(`${this.baseURL}/api/auth/register`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          username: userData.username,\n          email: userData.email,\n          password: userData.password,\n          full_name: `${userData.firstName} ${userData.lastName}`,\n          phone: userData.phone || null,\n          user_type: 'Student' // บังคับเป็น Student\n        })\n      });\n      const data = await response.json();\n      if (!response.ok) {\n        throw new Error(data.detail || 'Registration failed');\n      }\n      return {\n        success: true,\n        data: data,\n        message: 'สมัครสมาชิกสำเร็จ'\n      };\n    } catch (error) {\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  }\n\n  // ✅ เข้าสู่ระบบ\n  async login(credentials) {\n    try {\n      const response = await fetch(`${this.baseURL}/api/auth/login`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          username: credentials.username,\n          password: credentials.password\n        })\n      });\n      const data = await response.json();\n      if (!response.ok) {\n        throw new Error(data.detail || 'Login failed');\n      }\n\n      // บันทึก token และข้อมูล user\n      this.setToken(data.access_token);\n      this.setCurrentUser(data.user_info);\n      return {\n        success: true,\n        data: data,\n        message: 'เข้าสู่ระบบสำเร็จ'\n      };\n    } catch (error) {\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  }\n\n  // ✅ ออกจากระบบ\n  async logout() {\n    try {\n      // เรียก API logout (ถ้ามี)\n      const token = this.getToken();\n      if (token) {\n        await fetch(`${this.baseURL}/api/auth/logout`, {\n          method: 'POST',\n          headers: this.getAuthHeaders()\n        });\n      }\n    } catch (error) {\n      console.error('Logout API error:', error);\n    } finally {\n      // ลบข้อมูลจาก localStorage\n      this.removeToken();\n      return {\n        success: true,\n        message: 'ออกจากระบบแล้ว'\n      };\n    }\n  }\n\n  // ✅ ดูข้อมูลผู้ใช้ปัจจุบัน\n  async getMe() {\n    try {\n      const response = await fetch(`${this.baseURL}/api/auth/me`, {\n        method: 'GET',\n        headers: this.getAuthHeaders()\n      });\n      const data = await response.json();\n      if (!response.ok) {\n        throw new Error(data.detail || 'Failed to fetch user data');\n      }\n\n      // อัปเดตข้อมูล user ใน localStorage\n      this.setCurrentUser(data);\n      return {\n        success: true,\n        data: data\n      };\n    } catch (error) {\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  }\n\n  // ✅ ตรวจสอบว่า login อยู่หรือไม่\n  isAuthenticated() {\n    const token = this.getToken();\n    const user = this.getCurrentUser();\n    return token && user;\n  }\n\n  // ✅ เปลี่ยนรหัสผ่าน\n  async changePassword(passwordData) {\n    try {\n      const response = await fetch(`${this.baseURL}/api/auth/change-password`, {\n        method: 'POST',\n        headers: this.getAuthHeaders(),\n        body: JSON.stringify(passwordData)\n      });\n      const data = await response.json();\n      if (!response.ok) {\n        throw new Error(data.detail || 'Failed to change password');\n      }\n      return {\n        success: true,\n        message: 'เปลี่ยนรหัสผ่านสำเร็จ'\n      };\n    } catch (error) {\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  }\n}\n\n// Create singleton instance\nconst authServiceInstance = new AuthService();\n\n// Export singleton instance with named export\nexport default authServiceInstance;","map":{"version":3,"names":["API_BASE_URL","AuthService","constructor","baseURL","getToken","localStorage","getItem","setToken","token","setItem","removeToken","removeItem","getCurrentUser","userStr","JSON","parse","setCurrentUser","user","stringify","getAuthHeaders","register","userData","response","fetch","method","headers","body","username","email","password","full_name","firstName","lastName","phone","user_type","data","json","ok","Error","detail","success","message","error","login","credentials","access_token","user_info","logout","console","getMe","isAuthenticated","changePassword","passwordData","authServiceInstance"],"sources":["D:/BackUP FinalProject(โปรเจคจบ)/ai-resume-screening-system/frontend/src/services/authService.js"],"sourcesContent":["// frontend/src/services/authService.js\r\nimport { API_BASE_URL } from '../config';\r\n\r\nclass AuthService {\r\n  constructor() {\r\n    this.baseURL = API_BASE_URL;\r\n  }\r\n\r\n  // ดึง token จาก localStorage\r\n  getToken() {\r\n    return localStorage.getItem('token');\r\n  }\r\n\r\n  // บันทึก token ลง localStorage\r\n  setToken(token) {\r\n    localStorage.setItem('token', token);\r\n  }\r\n\r\n  // ลบ token จาก localStorage\r\n  removeToken() {\r\n    localStorage.removeItem('token');\r\n    localStorage.removeItem('user');\r\n  }\r\n\r\n  // ดึงข้อมูล user จาก localStorage\r\n  getCurrentUser() {\r\n    const userStr = localStorage.getItem('user');\r\n    return userStr ? JSON.parse(userStr) : null;\r\n  }\r\n\r\n  // บันทึกข้อมูล user ลง localStorage\r\n  setCurrentUser(user) {\r\n    localStorage.setItem('user', JSON.stringify(user));\r\n  }\r\n\r\n  // สร้าง headers สำหรับ API requests\r\n  getAuthHeaders() {\r\n    const token = this.getToken();\r\n    return {\r\n      'Content-Type': 'application/json',\r\n      ...(token && { 'Authorization': `Bearer ${token}` })\r\n    };\r\n  }\r\n\r\n  // ✅ สมัครสมาชิก\r\n  async register(userData) {\r\n    try {\r\n      const response = await fetch(`${this.baseURL}/api/auth/register`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          username: userData.username,\r\n          email: userData.email,\r\n          password: userData.password,\r\n          full_name: `${userData.firstName} ${userData.lastName}`,\r\n          phone: userData.phone || null,\r\n          user_type: 'Student' // บังคับเป็น Student\r\n        }),\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (!response.ok) {\r\n        throw new Error(data.detail || 'Registration failed');\r\n      }\r\n\r\n      return {\r\n        success: true,\r\n        data: data,\r\n        message: 'สมัครสมาชิกสำเร็จ'\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        success: false,\r\n        error: error.message\r\n      };\r\n    }\r\n  }\r\n\r\n  // ✅ เข้าสู่ระบบ\r\n  async login(credentials) {\r\n    try {\r\n      const response = await fetch(`${this.baseURL}/api/auth/login`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          username: credentials.username,\r\n          password: credentials.password,\r\n        }),\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (!response.ok) {\r\n        throw new Error(data.detail || 'Login failed');\r\n      }\r\n\r\n      // บันทึก token และข้อมูล user\r\n      this.setToken(data.access_token);\r\n      this.setCurrentUser(data.user_info);\r\n\r\n      return {\r\n        success: true,\r\n        data: data,\r\n        message: 'เข้าสู่ระบบสำเร็จ'\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        success: false,\r\n        error: error.message\r\n      };\r\n    }\r\n  }\r\n\r\n  // ✅ ออกจากระบบ\r\n  async logout() {\r\n    try {\r\n      // เรียก API logout (ถ้ามี)\r\n      const token = this.getToken();\r\n      if (token) {\r\n        await fetch(`${this.baseURL}/api/auth/logout`, {\r\n          method: 'POST',\r\n          headers: this.getAuthHeaders(),\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.error('Logout API error:', error);\r\n    } finally {\r\n      // ลบข้อมูลจาก localStorage\r\n      this.removeToken();\r\n      return {\r\n        success: true,\r\n        message: 'ออกจากระบบแล้ว'\r\n      };\r\n    }\r\n  }\r\n\r\n  // ✅ ดูข้อมูลผู้ใช้ปัจจุบัน\r\n  async getMe() {\r\n    try {\r\n      const response = await fetch(`${this.baseURL}/api/auth/me`, {\r\n        method: 'GET',\r\n        headers: this.getAuthHeaders(),\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (!response.ok) {\r\n        throw new Error(data.detail || 'Failed to fetch user data');\r\n      }\r\n\r\n      // อัปเดตข้อมูล user ใน localStorage\r\n      this.setCurrentUser(data);\r\n\r\n      return {\r\n        success: true,\r\n        data: data\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        success: false,\r\n        error: error.message\r\n      };\r\n    }\r\n  }\r\n\r\n  // ✅ ตรวจสอบว่า login อยู่หรือไม่\r\n  isAuthenticated() {\r\n    const token = this.getToken();\r\n    const user = this.getCurrentUser();\r\n    return token && user;\r\n  }\r\n\r\n  // ✅ เปลี่ยนรหัสผ่าน\r\n  async changePassword(passwordData) {\r\n    try {\r\n      const response = await fetch(`${this.baseURL}/api/auth/change-password`, {\r\n        method: 'POST',\r\n        headers: this.getAuthHeaders(),\r\n        body: JSON.stringify(passwordData),\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (!response.ok) {\r\n        throw new Error(data.detail || 'Failed to change password');\r\n      }\r\n\r\n      return {\r\n        success: true,\r\n        message: 'เปลี่ยนรหัสผ่านสำเร็จ'\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        success: false,\r\n        error: error.message\r\n      };\r\n    }\r\n  }\r\n}\r\n\r\n// Create singleton instance\r\nconst authServiceInstance = new AuthService();\r\n\r\n// Export singleton instance with named export\r\nexport default authServiceInstance;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}